#include <stdio.h>
#include <string.h>
#include <ctype.h>

#define MAX_WORDS 100

struct Word {
    char word[30];
    int count;
};

// Convert string to lowercase
void toLowerCase(char *str) {
    for (int i = 0; str[i]; i++)
        str[i] = tolower(str[i]);
}

// Remove punctuation
void removePunctuation(char *str) {
    int i, j = 0;
    char temp[200];

    for (i = 0; str[i]; i++) {
        if (isalnum(str[i]) || str[i] == ' ')
            temp[j++] = str[i];
    }
    temp[j] = '\0';
    strcpy(str, temp);
}

// Sort words by frequency (descending)
void sortWords(struct Word w[], int n) {
    struct Word temp;
    for (int i = 0; i < n - 1; i++) {
        for (int j = i + 1; j < n; j++) {
            if (w[i].count < w[j].count) {
                temp = w[i];
                w[i] = w[j];
                w[j] = temp;
            }
        }
    }
}

int main() {
    char sentence[200];
    struct Word words[MAX_WORDS];
    int wordCount = 0;
    FILE *fp;

    printf("Enter a sentence:\n");
    fgets(sentence, sizeof(sentence), stdin);

    toLowerCase(sentence);
    removePunctuation(sentence);

    // Tokenize sentence into words
    char *token = strtok(sentence, " ");

    while (token != NULL) {
        int found = 0;

        // Check if word already exists
        for (int i = 0; i < wordCount; i++) {
            if (strcmp(words[i].word, token) == 0) {
                words[i].count++;
                found = 1;
                break;
            }
        }

        // If new word
        if (!found) {
            strcpy(words[wordCount].word, token);
            words[wordCount].count = 1;
            wordCount++;
        }

        token = strtok(NULL, " ");
    }

    // Sort by frequency
    sortWords(words, wordCount);

    // Display result
    printf("\nWord Frequency:\n");
    for (int i = 0; i < wordCount; i++) {
        printf("%s : %d\n", words[i].word, words[i].count);
    }

    // Save to file
    fp = fopen("word_count.txt", "w");
    if (fp == NULL) {
        printf("Error saving file.\n");
        return 1;
    }

    for (int i = 0; i < wordCount; i++) {
        fprintf(fp, "%s : %d\n", words[i].word, words[i].count);
    }

    fclose(fp);

    printf("\nResults saved to word_count.txt\n");
    return 0;
}
